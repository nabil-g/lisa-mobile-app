<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Lisa</title>
    <link rel="stylesheet" href="lib/Framework7-1.5.3/dist/css/framework7.material.min.css">
    <link rel="stylesheet" href="lib/Framework7-1.5.3/dist/css/framework7.material.colors.css">
    <link rel="stylesheet" href="lib/iconfont/material-icons.css">
    <link rel="stylesheet" href="css/app.css">
  </head>
  <body>

    <div id="app" v-cloak>
      <f7-views>
        <f7-view main>
          <f7-pages navbar-fixed>

            <f7-page name="home">

              <f7-navbar>
                <f7-nav-left>
                  <f7-link icon-material="alarm_on" href="#" data-popup=".reminders-popup" class="open-popup"></f7-link>
                </f7-nav-left>
                 <f7-nav-center>Lisa</f7-nav-center>
                 <f7-nav-right>
                   <f7-link icon-material="settings" href="#" data-popup=".settings-popup" class="open-popup"></f7-link>
                 </f7-nav-right>
              </f7-navbar>

                <!-- BLOC LORSQUE L'APPLI EST CONNECTÉ -->

                <f7-block>

                    <f7-grid>

                      <!-- PLAYER -->
                        <f7-col width="100" tablet-width="25">
                          <f7-card>
                            <f7-card-header style="overflow:hidden">
                              <i> {{ musicStatus.musicTrack }}</i>
                            </f7-card-header>
                            <f7-card-content class="player-card">
                              <f7-link icon-material="skip_previous" href="#" @click="previous" class="no-ripple"></f7-link>

                              <f7-link v-bind:icon-material="musicStatus.musicPlaying ? 'pause' : 'play_arrow'" href="#" @click="togglePlay" class="no-ripple"></f7-link>

                              <f7-link icon-material="skip_next" href="#" @click="next" class="no-ripple"></f7-link>


                              <f7-link v-bind:class="{ active : musicStatus.musicRepeat }" icon-material="repeat" href="#" @click="toggleRepeat" class="no-ripple"></f7-link>

                              <f7-link v-bind:class="{ active : musicStatus.musicShuffle }" icon-material="shuffle" href="#" @click="toggleShuffle" class="no-ripple"></f7-link>

                              <f7-link icon-material="stop" href="#" @click="stop" class="no-ripple"></f7-link>

                            </f7-card-content>
                          </f7-card>
                        </f7-col>


                        <!-- WEATHER -->
                      <f7-col width="100" tablet-width="25" v-if="weather">
                        <f7-card>
                          <f7-card-content>

                            <f7-grid>
                              <f7-col width="40">
                                <img v-bind:src="'weather_icons/' + weather.weather[0].icon +'.png'" />
                              </f7-col>

                              <f7-col width="60">

                                  <h3><b>{{weather.name | capitalize}}</h3><h2>{{weather.main.temp | round }}&deg; {{degreesUnits}}</b></h2>
                                  <p> {{weather.weather[0].description}}
                                  <br>
                                  Min : {{weather.main.temp_min}}&deg;
                                  Max : {{weather.main.temp_max}}&deg;
                              </p>
                              </f7-col>
                              <p style="color: grey;font-style: italic">
                                Last update : {{ weather.dt | moment }}
                              </p>
                            </f7-grid>


                          </f7-card-content>
                        </f7-card>
                      </f7-col>



                    <!-- ALARM -->
                      <f7-col width="100" tablet-width="25">
                        <f7-card>
                          <f7-card-header>
                            <f7-icon material="alarm"></f7-icon>
                            Alarm
                          </f7-card-header>
                          <f7-card-content>

                            <f7-list form>

                              <f7-list-item>
                                <f7-input type="switch" v-model.lazy="settings.alarm.enabled"></f7-input>
                              </f7-list-item>

                              <f7-list-item v-if="settings.alarm.enabled">
                                <f7-input type="time" v-model.lazy="alarmTime"></f7-input>
                              </f7-list-item>

                            </f7-list>

                          </f7-card-content>
                        </f7-card>
                      </f7-col>

                    </f7-grid>



                </f7-block>

                <f7-fab color="pink" @click="refresh">
                  <f7-icon material="refresh"></f7-icon>
                </f7-fab>




            </f7-page>

          </f7-pages>
        </f7-view>

<!-- POP-UPS -->

        <!-- REMINDERS -->
        <f7-popup class="popup reminders-popup">
          <f7-view>
            <f7-pages navbar-fixed>
              <f7-page>
                <f7-navbar>
                  <f7-nav-center>Reminders</f7-nav-center>
                  <f7-nav-right>
                    <f7-link icon-material="close" href="#" class="close-popup"></f7-link>
                  </f7-nav-right>
                </f7-navbar>

                <f7-list form>
                  <f7-list-item>
                    <f7-label>Select date</f7-label>
                    <f7-input type="datetime-local" v-model.lazy="inputDatetime"></f7-input>
                  </f7-list-item>
                  <f7-list-item>
                    <f7-label floating>Text to be spoken</f7-label>
                    <f7-input type="textarea" v-model.lazy="inputReminderText"></f7-input>
                    <f7-button raised fill color="green" @click="addReminder">Add</f7-button>
                  </f7-list-item>
                </f7-list>

                <f7-block>
                  <f7-card v-for="(reminder, index) in settings.reminders">
                    <f7-list>
                      <f7-list-item>
                        <f7-input type="datetime-local" v-model="settings.reminders[index].date"></f7-input>
                        <f7-button color="red" icon-material="delete" @click="deleteReminder(index)"></f7-button>
                      </f7-list-item>
                      <f7-list-item>
                        <f7-input type="textarea" v-model="settings.reminders[index].text"></f7-input>
                      </f7-list-item>
                    </f7-list>
                  </f7-card>
                </f7-block>

              </f7-page>
            </f7-pages>
          </f7-view>
        </f7-popup>

        <!-- SETTINGS -->

        <f7-popup class="popup settings-popup">
          <f7-view>
            <f7-pages navbar-fixed>
              <f7-page>
                <f7-navbar>
                   <f7-nav-center>Settings</f7-nav-center>
                   <f7-nav-right>
                     <f7-link icon-material="close" href="#" class="close-popup"></f7-link>
                   </f7-nav-right>
                </f7-navbar>

                <f7-block-title>General</f7-block-title>

                <f7-list tablet-inset form>
                  <f7-list-item>
                    <f7-label>App language</f7-label>
                    <f7-input type="select" v-model.lazy="settings.appLanguage">
                      <option value="en">English</option>
                      <option value="fr">Français</option>
                    </f7-input>
                  </f7-list-item>
                  <f7-list-item>
                    <f7-label>Voice recognition and speech synthesis language</f7-label>
                    <f7-input type="select" v-model.lazy="settings.voiceLanguage">
                      <option value="en">English</option>
                      <option value="fr">Français</option>
                    </f7-input>
                    <f7-list-item>
                      <f7-icon slot="media" material="music_note"></f7-icon>
                      <f7-label>Music on wake</f7-label>
                      <f7-input type="switch" v-model.lazy="settings.alarm.music_onwake"></f7-input>
                    </f7-list-item>
                  </f7-list-item>

                </f7-list>

            <f7-block-title>Mail notifications on wake</f7-block-title>
            <f7-list tablet-inset form>

              <f7-list-item>
                <f7-icon slot="media" material="check"></f7-icon>
                <f7-label>Enable</f7-label>
                <f7-input type="switch" v-model.lazy="settings.mail.enabled"></f7-input>
              </f7-list-item>

              <f7-list-item v-if="settings.mail.enabled">
                <f7-icon slot="media" material="http"></f7-icon>
                <f7-label>Host</f7-label>
                <f7-input type="url" v-model.lazy="settings.mail.host"></f7-input>
              </f7-list-item>

              <f7-list-item v-if="settings.mail.enabled">
                <f7-icon slot="media" material="person"></f7-icon>
                <f7-label>Username (address)</f7-label>
                <f7-input type="email" v-model.lazy="settings.mail.username"></f7-input>
              </f7-list-item>

              <f7-list-item v-if="settings.mail.enabled">
                <f7-icon slot="media" material="lock"></f7-icon>
                <f7-label>Password</f7-label>
                <f7-input type="password" v-model.lazy="settings.mail.password"></f7-input>
              </f7-list-item>

            </f7-list>


            <f7-block-title>Weather</f7-block-title>

            <f7-block>
            <f7-list tablet-inset form>
              <f7-list-item>
                <f7-icon slot="media" material="vpn_key"></f7-icon>
                <f7-label>API key</f7-label>
                <f7-input type="text" v-model.lazy="settings.weather.weather_id"></f7-input>
              </f7-list-item>

              <f7-list-item>
                <f7-icon slot="media" material="place"></f7-icon>
                <f7-label>City ID</f7-label>
                <f7-input type="text" v-model.lazy="settings.weather.cityID"></f7-input>
              </f7-list-item>

              <f7-list-item>
                <f7-icon slot="media" material="language"></f7-icon>
                <f7-label>Units</f7-label>
                <f7-input type="select" v-model.lazy="settings.weather.units">
                  <option value="metric">Celsius</option>
                  <option value="imperial">Fahrenheit</option>
                  <option value="">Kelvin</option>
                </f7-input>
              </f7-list-item>

              <f7-list-label><i>Please note that your settings are stored without any encryption in a JSON file.</i></f7-list-label>
            </f7-list>

            <p>
              <f7-button color="red" @click="stopLisa" raised fill>Stop Lisa</f7-button>
            </p>
            <p>
              <f7-button color="green" @click="shutdown" raised fill>Shutdown the host server</f7-button>
            </p>
          </f7-block>
          </f7-page>
        </f7-pages>

        </f7-view>
        </f7-popup>

      </f7-views>


      <f7-login-screen>
        <f7-view>
          <f7-pages>
            <f7-page login-screen>
              <f7-login-screen-title>Lisa</f7-login-screen-title>
              <f7-block>

                <!--IF NO ADDRESS -->
                <div>
                  <p>
                    To connect to a Lisa server, please enter the IP address of the server over the local network.
                  </p>

                  <f7-list form v-on:submit.prevent>
                    <f7-list-item>
                      <f7-input v-model.lazy="address" type="text" placeholder="ex : 192.168.0.10"/>
                    </f7-list-item>
                    <p>
                      <f7-button v-show="address" @click="connect" raised fill>Connect</f7-button>
                    </p>
                  <f7-list>


                </div>


              </f7-block>
            </f7-page>
          </f7-pages>
        </f7-view>
      </f7-login-screen>

    </div>

    <script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="lib/Framework7-1.5.3/dist/js/framework7.min.js"></script>
    <script type="text/javascript" src="lib/vue.js"></script>
    <script type="text/javascript" src="lib/Framework7-Vue-0.8.5/dist/framework7-vue.js"></script>
    <script type="text/javascript" src="lib/socket.io.js"></script>
    <script type="text/javascript" src="lib/moment-with-locales.js"></script>
    <script type="text/javascript" src="js/app.js"></script>
    <script type="text/javascript" src="js/connect.js"></script>
  </body>
</html>
